# ChangeLog

___

## v0.2.0

修复了标准版吕布属性杀不触发无双、貂蝉决斗可被无懈。

由于标准包更加完善了，所以增加一位中版本号。

1. 获得了中文名“新月杀”
2. 房间可设置密码
3. 手牌上限不等于HP时会显示
4. 修禁用铁锁无法重铸
5. 修视为技按钮一直亮着
6. 使命技机制，完善游戏逻辑
7. 拖孩

___

## v0.1.9

1. 实现移动场上一张牌
2. 实现用作记录牌名并可查看的mark
3. 将askForChoice和interaction的文本解析方式改为prompt
4. 新增属性将牌移至牌堆指定索引位置
5. 修改时机“游戏开始时”至正确位置
6. 优化衍生牌逻辑
7. 新增“卡牌展示后”时机
8. 修改qml文件结构
9. 新增手气卡机制
10. 新增大厅表情功能
11. 新增选将时技能描述查看，以及查看卡牌描述的功能
12. 查看角色技能描述侧栏新增“送花”和“砸蛋”功能

___

## v0.1.8

1. 实现禁将功能
2. 实现转换技，新增发动转换技动画
3. 分离觉醒技的觉醒条件
4. 封装不同实例卡牌的花色、点数、颜色的比较，用于处理无花色等情况
5. 新增mark_enum.lua用于注册通用标记名
6. 实现将特定实现列表按结算顺序排序的函数
7. 允许UI解析值为数组的标记
8. 初步实现不加入牌堆中的衍生卡牌（待改进）

___

## v0.1.7

1. 增加最大选将18
2. 将退出房改为延迟按钮
3. 修虚拟闪电bug
4. 修看破bug
5. 增加长度限制
6. 将异步模块单独一个Lua
7. 修大厅卡死尸体
8. 修“已经有人登入”
9. 修服务端翻译文件
10. 增加出牌时间设置
11. 修Linux下复制文件bug
12. 再次尝试wasm
13. 增加双势力
14. 实现副势力概念，用于应对双势力机制
15. 完善神将及拥有副势力的武将开局选择势力的机制
16. 完成势力技概念
17. 实现ViewAsSkill在响应时对使用和打出的区分

___

## v0.1.6

1. 修复聊天系统
2. 修复拼点bug
3. 加入声音设置
4. 优化自由选将

___

## v0.1.5

1. 控制他人
2. 观星增加限制参数
3. 修野心家bug
4. 修死人连锁/翻面bug
5. 修中闪电不传导
6. 禁止技也影响视为技等等
7. 火攻交互优化

___

## v0.1.4

看点：

1. 国战
2. 旧版朱然

修bug内容：

1. 游戏规则优先级bug
2. 插入新阶段
3. 蜀护驾改魏护驾
4. 为card也增加了mark，但尚不实用

___

## v0.1.3

1. 优化了武将一览和卡牌一览的UI。
2. 增强exppattern
3. 引入调试器，在Lua代码中调用`dbg()`可以下断点
4. 修复cloneCard未复制is_damage_card

___

## v0.1.2

一次更小的更新。

1. 修复单机启动闪退
2. 公告也发送到聊天里面
3. 上线/下线时发送公告

___

## v0.1.1

一次小更新。

主要看点：

1. 双将
2. 旁观者聊天、大厅聊天优化
3. 对局中显示牌堆数和轮数

详细：

1. 修检验md5失效
2. 修因心跳包导致整个游戏停跳的bug
3. 增加主公技配音和台词
4. 修一些和TargetMod有关的bug
5. 修发送语音时显示undefined的bug
6. 增加服务端广播消息功能
7. 优化游戏Log机制
8. 开启服务端读config的接口备用
9. 修复倾国响应时点击技能按钮会直接取消出闪的bug
10. 优化标记文本的显示
11. 修只有一张子卡的虚拟牌没花色
12. 为无花色牌显示他的颜色

___

## v0.1.0

标准包终于完结！版本号也随机升了一位

主要新机制：

1. 主公技
2. 护甲机制
3. AES加密通信

新机制：

1. 添加武将相关技能
2. 添加武将中性和无性
3. 给Card堆一个伤害牌属性
4. 能添加虚拟牌为子卡
5. 封装了“视为使用xx牌”的函数
6. 护甲机制
7. interaction现在可以作为一个函数，以实现动态化
8. 冰属性伤害
9. 使用牌堆中的牌不再报错

修bug：

1. 修流离锁定技
2. 修斧子弃自己
3. 修顺手空城卡死
4. 修旁观者id是自己的
5. 修旁观者再开新局就闪退（或许吧）
6. 修拼点报nil
7. 修询问无懈时旁观者被卡在外面
8. 修Room的请求队列不清理干净

___

## v0.0.8

1. 禁止使用打出弃置
2. 为FilterSkill加player参数
3. 对局中可查看他人技能
4. GameEvent相关设施
5. 添加时机或事件：轮次
6. 以-round等方式结尾的标记会被自动清理，详见源码
7. 增加了NixOS用的构建脚本

修bug：

1. 流离bug
2. 觉醒技显示方式反过来
3. 询问无懈时100% CPU占用
4. skill.interaction无效
5. 装备从自己装备区移动到别人
6. 觉醒技cost和锁定技不一样
7. 狮子给死人加血
8. 拖曳体验差
9. 暂时禁用旁观功能，bug太多
10. 【杀】的distance_limit_func无效bug

___

## v0.0.7

1. 文档已经上线，内容应该是很多的，就是没写完
2. 重新设计了Card.skillName，并给各种cloneCard补上了skillName（仅限于FK核心涉及的）
3. 给好几个交互加个cancelable/prompt参数，把prompt美化了一下
4. 为老周泰做了一些耦合
5. 点击私人牌堆的名字可以弹出牌数量了，而不是一堆数字
6. 主动技/视为技能借助额外的UI交互以提前收集更多数据，可用于泛转化
7. 限定技/觉醒技在Photo上显示的UI
8. 修复了kingdom属性没有被实际赋值的bug
9. 移动了equipIcon的素材位置
10. 移动力kingdom相关素材的位置，现在可以在mod中自订势力
11. 大厅内显示在线人数，大厅内聊天
12. 心跳包机制，防掉线和卡在服务器
13. 服务端shell现在可以踢人

___

## v0.0.6

1. 修bug
2. 增加个更多展示移动牌的log
3. 同名武将替换
4. UI更新
5. 补全所有卡牌

___

## v0.0.5

1. 五谷丰登和酒
2. 开房可自选游戏模式，可拓展游戏模式
3. 开房可自选开启的拓展包
4. 安全性加强
5. 支持拼点
6. 修bug

___

## v0.0.4

Tag: v0.0.4

1. 制作了军争包大部分卡牌
2. 在计算完md5后立刻删除flist.txt
3. 修bug
4. 将摸初始牌和执行回合计入事件中
5. 允许使用-DFK_SERVER_ONLY宏来编译不含GUI支持的版本
6. 避免每次启动都复制资源文件

___

## v0.0.3

Tag: v0.0.3

大改动：

1. 重写事件体系，参考[doc/dev/gameevent.md](./doc/dev/gameevent.md)
2. 增加私人牌堆交互功能，可以写出像邓艾这样的武将了
3. 增加了五谷选牌框，但未实装
4. 八卦阵和“无双”
5. 添加了询问同时选择一名玩家多张牌的交互

小改动：

1. 修复选牌框bug
2. Android版的应用数据从内部存储转移到外部存储
3. Win版exe现在有图标了

___

## v0.0.2

Tag: v0.0.2

较大变动：

1. 添加了更多文档，包括DIY的基本文档
2. 完成了大多数装备，除了八卦阵、青釭剑
3. 完成了标准包技能：离间,流离
4. 添加了对玩家私人牌堆的支持
5. 修复了Libgit2相关的bug，从此拓展包同步更加正确快捷
6. 添加了在拓展包中通过QML任意指定交互方式的办法
7. 重构了ActiveSkill中和feasible有关的部分，不过旧版风格的直接指定feasible函数仍然有效
8. AI框架完工，初步制作了随机型AI（哪里亮了点哪）
9. 初步支持国际化，将一些东西翻译成了英文

小变动：

1. 编译安卓时，不再把rsa密钥也打包进去
2. 不让lua服务端进入死循环，当等待时间充足时睡眠10ms
3. 将lua/vscode更名为lua/lsp，并针对类的静态函数加入了补全信息
4. 将检测房间是否没有活人的环节移动到AI处理事项之前
5. 装修了一下README
6. 修一堆bug
